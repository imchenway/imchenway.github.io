.sidebar.animated.fadeInDown
  .logo-title
    .title
      //- img(src= url_for('images/WechatIMG1.jpeg'),style="width:127px;")
      h3(title="")
        a(href="/")= config.title
      if theme.description
        .description
          p!= theme.description

  - var githubToggle = theme.show_github
  - var enableGithub = !(githubToggle === false || githubToggle === 'false' || githubToggle === 0 || githubToggle === '0')
  ul.social-links
    if enableGithub && theme.github
      li
        a(href=theme.github)
          i.fa.fa-github
    if theme.twitter
      li
        a(href="https://twitter.com/" + theme.twitter)
          i.fa.fa-twitter
    if theme.instagram
      li
        a(href="http://instagram.com/" + theme.instagram)
          i.fa.fa-instagram
    if theme.rss
      li
        a(href= url_for(theme.rss))
          i.fa.fa-rss
    if theme.weibo
      li
        a(href="http://weibo.com/" + theme.weibo)
          i.fa.fa-weibo
    if theme.wechat
      li
        a.wechat-trigger(href="javascript:void(0);")
          i.fa.fa-wechat

    h3(title="")

    - var themeShowTags = theme.show_tags
    - var enableTags = !(themeShowTags === false || themeShowTags === 'false' || themeShowTags === 0 || themeShowTags === '0')
    - var sidebarHasCategories = site.categories && site.categories.length
    - var sidebarHasTags = site.tags && site.tags.length
    - var tagsLimit = 20
    - var limitedTags = sidebarHasTags ? site.tags.sort('date').slice(0, tagsLimit) : []
    if enableTags && (sidebarHasCategories || sidebarHasTags)
      li
        i.fa.fa-tag
        if sidebarHasCategories
          - site.categories.sort('posts').each(function(category) {
              a.tag(href=config.root + category.path, title= category.name)= category.name + " "
          - });
        if sidebarHasTags
          - limitedTags.forEach(function(tag) {
              a.tag(href=config.root + tag.path, title= tag.name)= tag.name + " "
          - });

      include footer

  if theme.wechat
    style.
      .wechat-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.65);
        z-index: 2147483000;
      }
      .wechat-modal.is-active {
        display: flex;
      }
      .wechat-modal__content {
        position: relative;
        background: #fff;
        padding: 20px;
        border-radius: 6px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        max-width: 90vw;
        max-height: 90vh;
        z-index: 2147483001;
      }
      .wechat-modal__image {
        max-width: 70vw;
        max-height: 70vh;
        display: block;
      }
      .wechat-modal__close {
        position: absolute;
        top: -12px;
        right: -12px;
        width: 28px;
        height: 28px;
        line-height: 28px;
        text-align: center;
        border-radius: 50%;
        background: #fff;
        color: #333;
        font-size: 20px;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      }

    #wechat-modal.wechat-modal(style="display:none;")
      .wechat-modal__content
        span.wechat-modal__close &times;
        img.wechat-modal__image(src=theme.wechat, alt='WeChat QR code')

    script.
      document.addEventListener('DOMContentLoaded', function () {
        var trigger = document.querySelector('.wechat-trigger');
        var modal = document.getElementById('wechat-modal');
        if (!trigger || !modal) return;
        if (modal.parentNode !== document.body) {
          document.body.appendChild(modal);
        }
        var closeBtn = modal.querySelector('.wechat-modal__close');
        var show = function () {
          modal.style.display = 'flex';
          modal.classList.add('is-active');
        };
        var hide = function () {
          modal.classList.remove('is-active');
          modal.style.display = 'none';
        };
        hide();
        trigger.addEventListener('click', function (event) {
          event.preventDefault();
          show();
        });
        closeBtn && closeBtn.addEventListener('click', hide);
        modal.addEventListener('click', function (event) {
          if (event.target === modal) hide();
        });
      });
