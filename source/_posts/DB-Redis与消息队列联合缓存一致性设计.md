---
title: Redis与消息队列联合的缓存一致性设计
date: 2024-04-24
tags: ['#Database']
---

### 本文目录
<!-- toc -->

# 引言
> 缓存与数据库之间存在更新延迟。结合消息队列可实现高可靠的缓存一致性。本文总结设计模式与实践。

# 模式一： Cache Aside + 异步通知
- 更新数据库后发送 MQ 消息；
- 消费者刷新或失效缓存；
- 支持多实例同步。

# 模式二：双写队列
- 更新请求写入队列；
- 消费者串行更新数据库与缓存；
- 保证顺序一致。

# 模式三：订阅数据库变更
- 使用 CDC（Debezium）更新缓存；
- 适合多系统共享缓存。

# 可靠性
- 消息幂等处理；
- 重试与死信队列；
- 缓存失效兜底：短暂回源数据库。

# 监控
- 缓存命中率、刷新失败数；
- MQ 延迟；
- 数据一致性对账（采样）；
- 告警触发回滚或人工介入。

# 总结
利用消息队列辅助缓存更新，可提升一致性与扩展性。关键在于幂等、监控与故障处理设计。

# 参考资料
- [1] Alibaba 中台缓存一致性实践.
- [2] Redis Labs Cache Patterns.
